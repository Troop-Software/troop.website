<div class="card-content">
  <% scout_alert, scout_alert_message = obj.scout_alert %>
  <div class="row">
    <div class="card card-stats">
      <div class="card-header" data-background-color="dark blue">
        <img src="/assets/ranks/<%= obj.rank.name %>.png" class="img-card-rank">
      </div>

      <div class="card-content">
        <% unless scout_alert.nil? %>
            <div class="col-xs-9 text-<%= scout_alert %> text-center">
              <%= scout_alert_message %>
            </div>
        <% end %>
        <% obj.rank_id += 1 %>
        <% requirements_for_rank = Requirement.where(rank_id: obj.rank_id) %>
        <% completed_requirement_count = 0
           requirements_for_rank.each do |req|
             completed_requirement = ScoutRequirement.where(requirement_id: req.id, scout_id: obj.id)
             completed_requirement_count += 1 unless completed_requirement.empty?

           end %>
        <%

        %>
        <% rank_completed = number_to_percentage(
            (completed_requirement_count / requirements_for_rank.count.to_f) * 100, precision: 0) %>
        <% obj.rank_id -= 1 %>
        <div class="col-xs-9" %>
          <div class="text-center">Progress towards next rank&#8230;</div>
          <div class="progress">
            <div class="progress-bar progress-bar-info progress-bar-striped" role="progressbar"
                 aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"
                 style="min-width: 2em; width: <%= rank_completed %>;"><%= rank_completed %>
            </div>
          </div>
        </div>
        <p class="category"><%= obj.patrol.name %></p>
        <h3 class="title"><%= obj.rank.name %></h3>

        <div class="row">
          <table class="table">
            <tr>

            </tr>
            <tr>
              <td class="text-primary bold">Email:</td>
              <td><%= obj.email %></td>
              <td></td>
              <td></td>
              <td class="text-primary bold">Phone:</td>
              <td><%= number_to_phone(obj.phone, area_code: true) %></td>
            </tr>
            <tr>
              <td class="text-primary bold">Grade:</td>
              <td><%= obj.grade %></td>
              <td class="text-primary bold">Age:</td>
              <td><%= "#{obj.age(obj.birthdate)} yrs old" unless obj.birthdate.nil? %></td>
              <td class="text-primary bold">Birth Date:</td>
              <td><%= date_for_display(obj.birthdate) %></td>
            </tr>
            <tr>
              <td class="text-primary bold">Position:</td>
              <td><%= obj.position.name %></td>
              <td class="text-primary bold">BSA ID:</td>
              <td><%= obj.bsa_id %></td>
              <td class="text-primary bold">Joined:</td>
              <td><%= date_for_display(obj.joined) %></td>
            </tr>
          </table>

        </div>
      </div>
    </div>
  </div>
</div>


